{"version":3,"file":"bundle.user.js","mappings":";;;;;;;;;;;;;;;;;;;;;;;;;;;;AAAA;AACA;AACO;AACP;AACA;AACA;AACA;AACA;AACA;AACA,OAAO;AACP,6BAA6B,QAAQ;AACrC;AACA;AACA;AACA;AACA;AACA,YAAY;AACZ;AACA;AACA,UAAU;AACV;AACA;AACA,OAAO;AACP;AACA;AACA,OAAO;AACP,KAAK;AACL,GAAG;AACH;AACA;AACO;AACP;AACA;AACA;AACA;AACA;AACA;AACA,OAAO;AACP,6BAA6B,SAAS;AACtC;AACA;AACA;AACA;AACA;AACA,YAAY;AACZ;AACA;AACA,UAAU;AACV;AACA;AACA,OAAO;AACP;AACA;AACA,OAAO;AACP,KAAK;AACL,GAAG;AACH;AACA;AACO;AACP;AACA;AACA;AACA;AACA;AACA;AACA,OAAO;AACP;AACA;AACA;AACA;AACA,OAAO;AACP;AACA;AACA;AACA;AACA;AACA,YAAY;AACZ;AACA;AACA,UAAU;AACV;AACA;AACA,OAAO;AACP;AACA;AACA,OAAO;AACP,KAAK;AACL,GAAG;AACH;;;;;;;;;;;;;;;;ACxFA;AACA;AACO;AACP;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,kBAAkB,iCAAiC;AACnD,iBAAiB,mCAAmC;AACpD;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,yBAAyB;AACzB;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,OAAO;AACP;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,UAAU;AACV;AACA;AACA;AACA;AACA,uHAAuH;AACvH;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,wBAAwB;AACxB;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,MAAM;AACN;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,WAAW,UAAU;AACrB;AACA;AACA,oBAAoB,0BAA0B;AAC9C;AACA;AACA;AACA;AACO;AACP;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,gDAAgD;AAChD;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,uDAAuD;AACvD;AACA,oFAAoF;AACpF;AACA;AACA;AACA;AACA;AACA;AACA,8EAA8E,aAAa;AAC3F;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,qBAAqB;AACrB;AACA;AACA,qBAAqB;AACrB;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,qBAAqB;AACrB;AACA;AACA;AACA;AACA;AACA,qBAAqB;AACrB;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,gCAAgC;AAChC;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,GAAG;AACH;AACA;AACA;AACA,GAAG;AACH;AACA;AACA;AACA,wBAAwB;AACxB;AACA;AACA,GAAG;AACH;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,yBAAyB;AACzB;AACA,GAAG;AACH;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,MAAM;AACN;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,OAAO;AACP;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,MAAM;AACN;AACA;AACA,GAAG;AACH;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,KAAK;AACL,GAAG;AACH;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,OAAO;AACP;AACA,KAAK;AACL;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,YAAY;AACZ;AACA;AACA;AACA;AACA;AACA;AACA,OAAO;AACP,KAAK;AACL,GAAG;AACH;AACA;AACA;AACA;AACA;AACA,KAAK;AACL,GAAG;AACH;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,OAAO;AACP;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,YAAY;AACZ;AACA;AACA;AACA;AACA;AACA;AACA;AACA,OAAO;AACP,KAAK;AACL,GAAG;AACH;AACA;AACA;AACA;;;;;;;UCpsBA;UACA;;UAEA;UACA;UACA;UACA;UACA;UACA;UACA;UACA;UACA;UACA;UACA;UACA;UACA;;UAEA;UACA;;UAEA;UACA;UACA;;;;;WCtBA;WACA;WACA;WACA;WACA,yCAAyC,wCAAwC;WACjF;WACA;WACA;;;;;WCPA;;;;;WCAA;WACA;WACA;WACA,uDAAuD,iBAAiB;WACxE;WACA,gDAAgD,aAAa;WAC7D;;;;;;;;;;;;;ACNA;AACA;AAC4D;AACK;AACjE;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,iCAAiC,sDAAa;AAC9C;AACA;AACA;AACA,UAAU,2DAAmB;AAC7B;AACA;AACA;AACA;AACA,sBAAsB,+CAAM;AAC5B;AACA,cAAc;AACd,8BAA8B,mBAAmB;AACjD;AACA,wBAAwB,+CAAM;AAC9B;AACA;AACA;AACA;AACA;AACA;AACA,KAAK;AACL;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,OAAO;AACP;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,OAAO;AACP;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,gEAAgE;AAChE;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,kBAAkB;AAClB;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,mBAAmB;AACnB;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,gBAAgB;AAChB;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,YAAY;AACZ;AACA;AACA;AACA;AACA;AACA,OAAO;AACP;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,oDAAoD;AACpD,YAAY;AACZ;AACA;AACA;AACA;AACA,OAAO;AACP;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,KAAK;AACL;AACA;AACA;AACA;AACA;AACA;AACA,IAAI,yDAAiB;AACrB;AACA;AACA,KAAK,GAAG;AACR;AACA;AACA;AACA;AACA;AACA;AACA;AACA,iCAAiC;AACjC;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,UAAU,2DAAmB;AAC7B,mCAAmC;AACnC;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,WAAW;AACX,UAAU;AACV;AACA;AACA,QAAQ;AACR;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,iBAAiB;AACjB;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,gBAAgB;AAChB;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,kBAAkB;AAClB;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,mBAAmB;AACnB;AACA;AACA,cAAc;AACd;AACA;AACA;AACA;AACA;AACA,KAAK;AACL;AACA;AACA;AACA,CAAC","sources":["webpack://tampermonkey/./src/api.js","webpack://tampermonkey/./src/ui.js","webpack://tampermonkey/webpack/bootstrap","webpack://tampermonkey/webpack/runtime/define property getters","webpack://tampermonkey/webpack/runtime/hasOwnProperty shorthand","webpack://tampermonkey/webpack/runtime/make namespace object","webpack://tampermonkey/./src/main.js"],"sourcesContent":["// src/api.js\r\n\r\nexport async function getAnswer(prompt) {\r\n  return new Promise((resolve, reject) => {\r\n    GM_xmlhttpRequest({\r\n      method: \"POST\",\r\n      url: \"http://localhost:3000/api/process\",\r\n      headers: {\r\n        \"Content-Type\": \"application/json\",\r\n      },\r\n      data: JSON.stringify({ prompt }),\r\n      onload: function (response) {\r\n        if (response.status === 200) {\r\n          try {\r\n            const data = JSON.parse(response.responseText);\r\n            resolve(data);\r\n          } catch (e) {\r\n            reject(\"JSON parse error: \" + e);\r\n          }\r\n        } else {\r\n          reject(\"API failed with status: \" + response.status);\r\n        }\r\n      },\r\n      onerror: function (error) {\r\n        reject(\"API error: \" + error);\r\n      },\r\n    });\r\n  });\r\n}\r\n\r\nexport async function getHumanScore(answers) {\r\n  return new Promise((resolve, reject) => {\r\n    GM_xmlhttpRequest({\r\n      method: \"POST\",\r\n      url: \"http://localhost:3000/api/process/human-score\",\r\n      headers: {\r\n        \"Content-Type\": \"application/json\",\r\n      },\r\n      data: JSON.stringify({ answers }),\r\n      onload: function (response) {\r\n        if (response.status === 200) {\r\n          try {\r\n            const data = JSON.parse(response.responseText);\r\n            resolve(data);\r\n          } catch (e) {\r\n            reject(\"JSON parse error: \" + e);\r\n          }\r\n        } else {\r\n          reject(\"API failed with status: \" + response.status);\r\n        }\r\n      },\r\n      onerror: function (error) {\r\n        reject(\"API error: \" + error);\r\n      },\r\n    });\r\n  });\r\n}\r\n\r\nexport async function saveDB(question, answer, score) {\r\n  return new Promise((resolve, reject) => {\r\n    GM_xmlhttpRequest({\r\n      method: \"POST\",\r\n      url: \"http://localhost:3000/api/answer\",\r\n      headers: {\r\n        \"Content-Type\": \"application/json\",\r\n      },\r\n      data: JSON.stringify({\r\n        question,\r\n        answer,\r\n        score,\r\n      }),\r\n      onload: function (response) {\r\n        if (response.status === 200) {\r\n          try {\r\n            const data = JSON.parse(response.responseText);\r\n            resolve(data);\r\n          } catch (e) {\r\n            reject(\"JSON parse error: \" + e);\r\n          }\r\n        } else {\r\n          reject(\"API failed with status: \" + response.status);\r\n        }\r\n      },\r\n      onerror: function (error) {\r\n        reject(\"API error: \" + error);\r\n      },\r\n    });\r\n  });\r\n}\r\n","// src/ui.js\r\n\r\nexport function displayHumanElement(score, text, bottom) {\r\n  const stageFrame = document.getElementById(\"stageFrame\");\r\n  if (!stageFrame) return;\r\n\r\n  if (!document.querySelector(\"#custom-human-style\")) {\r\n    const rect = stageFrame.getBoundingClientRect();\r\n    let style = document.createElement(\"style\");\r\n    style.id = \"custom-human-style\";\r\n    style.innerHTML = `\r\n      .human-container {\r\n          position: absolute;\r\n          left: ${rect.right + 20 + window.scrollX}px;\r\n          top: ${rect.bottom - 100 + window.scrollY}px;\r\n          z-index: 1000;\r\n          display: flex;\r\n          flex-direction: column;\r\n          background: rgba(24, 24, 27, 0.65);\r\n          padding: 10px;\r\n          border-radius: 12px;\r\n          font-size: 14px;\r\n          box-shadow: inset 0 1px, inset 0 0 0 1px rgba(255, 255, 255, 0.025);\r\n          width: 150px;\r\n          height: 100px; /* Reduced height */\r\n          text-align: center;\r\n      }\r\n      .human-title {\r\n          display: flex;\r\n          align-items: center;\r\n          justify-content: center;\r\n          gap: 4px;\r\n          color: white;\r\n      }\r\n      .human-circle-container {\r\n          position: relative;\r\n          width: 100px;\r\n          height: 60px;\r\n          margin: 0 auto;\r\n      }\r\n      .human-circle {\r\n          fill: transparent;\r\n          stroke-width: 10;\r\n          transition: stroke-dashoffset 1s linear, stroke 0.3s ease;\r\n      }\r\n      .human-text {\r\n          font-size: 40px;\r\n          font-weight: bold;\r\n          transition: opacity 0.5s ease-in-out, fill 0.3s ease;\r\n      }`;\r\n    document.head.appendChild(style);\r\n  }\r\n\r\n  let container = document.createElement(\"div\");\r\n  container.className = \"human-container\";\r\n  container.innerHTML = `\r\n    <div class=\"human-title\">\r\n        <svg xmlns=\"http://www.w3.org/2000/svg\" width=\"20\" height=\"20\" viewBox=\"0 0 24 24\" fill=\"none\" stroke=\"currentColor\" stroke-width=\"2\" stroke-linecap=\"round\" stroke-linejoin=\"round\" class=\"lucide lucide-venetian-mask\">\r\n            <path d=\"M2 12a5 5 0 0 0 5 5 8 8 0 0 1 5 2 8 8 0 0 1 5-2 5 5 0 0 0 5-5V7h-5a8 8 0 0 0-5 2 8 8 0 0 0-5-2H2Z\"></path>\r\n            <path d=\"M6 11c1.5 0 3 .5 3 2-2 0-3 0-3-2Z\"></path>\r\n            <path d=\"M18 11c-1.5 0-3 .5-3 2 2 0 3 0 3-2Z\"></path>\r\n        </svg>\r\n        ${text}\r\n    </div>\r\n    <div class=\"human-circle-container\">\r\n        <svg width=\"100\" height=\"60\" viewBox=\"0 0 120 120\">\r\n            <circle class=\"human-circle progress\" cx=\"60\" cy=\"60\" r=\"48\" stroke=\"gray\" stroke-dasharray=\"301.59\" stroke-dashoffset=\"301.59\" transform=\"rotate(-90 60 60)\"></circle>\r\n            <text x=\"50%\" y=\"50%\" text-anchor=\"middle\" dominant-baseline=\"middle\" class=\"human-text\" style=\"fill: gray;\">0</text>\r\n        </svg>\r\n    </div>\r\n    `;\r\n  document.body.appendChild(container);\r\n\r\n  // Animate the human and circle progress together\r\n  let progressCircle = container.querySelector(\".progress\");\r\n  let scoreText = container.querySelector(\".human-text\");\r\n  let totalFrames = 60; // Approx. 1 second animation at 60fps\r\n  let frame = 0;\r\n\r\n  function animate() {\r\n    frame++;\r\n    let progress = Math.min(frame / totalFrames, 1);\r\n    let currentScore = Math.round(progress * score);\r\n    let offset = 301.59 - (currentScore / 100) * 301.59;\r\n\r\n    scoreText.textContent = currentScore;\r\n    progressCircle.style.strokeDashoffset = offset;\r\n\r\n    if (frame < totalFrames) {\r\n      requestAnimationFrame(animate);\r\n    } else {\r\n      progressCircle.style.stroke = \"green\";\r\n      scoreText.style.fill = \"white\";\r\n    }\r\n  }\r\n\r\n  requestAnimationFrame(animate);\r\n}\r\n/**\r\n * Creates and inserts a draggable menu into the DOM.\r\n * @param {Function} onStartCallback - Callback function that receives the configuration object:\r\n * {\r\n *   isActive: boolean,\r\n *   submitDelay: { min: number, max: number },\r\n *   answerDelay: number,\r\n *   typingStyle: string\r\n * }\r\n */\r\nexport function initDraggableMenu(onStartCallback) {\r\n  // 1. CREATE THE MENU CONTAINER\r\n  const menu = document.createElement(\"div\");\r\n  menu.id = \"autoWritingMenu\";\r\n  menu.innerHTML = `\r\n    <div class=\"menu-header\">\r\n      <button class=\"menu-title\">\r\n        <svg id=\"toggleArrow\" xmlns=\"http://www.w3.org/2000/svg\" width=\"20\" height=\"20\" viewBox=\"0 0 24 24\" fill=\"none\" stroke=\"currentColor\" stroke-width=\"2\" stroke-linecap=\"round\" stroke-linejoin=\"round\" class=\"lucide lucide-settings\">\r\n          <path d=\"M12.22 2h-.44a2 2 0 0 0-2 2v.18a2 2 0 0 1-1 1.73l-.43.25a2 2 0 0 1-2 0l-.15-.08a2 2 0 0 0-2.73.73l-.22.38a2 2 0 0 0 .73 2.73l.15.1a2 2 0 0 1 1 1.72v.51a2 2 0 0 1-1 1.74l-.15.09a2 2 0 0 0-.73 2.73l.22.38a2 2 0 0 0 2.73.73l.15-.08a2 2 0 0 1 2 0l.43.25a2 2 0 0 1 1 1.73V20a2 2 0 0 0 2 2h.44a2 2 0 0 0 2-2v-.18a2 2 0 0 1 1-1.73l.43-.25a2 2 0 0 1 2 0l.15.08a2 2 0 0 0 2.73-.73l.22-.39a2 2 0 0 0-.73-2.73l-.15-.08a2 2 0 0 1-1-1.74v-.5a2 2 0 0 1 1-1.74l.15-.09a2 2 0 0 0 .73-2.73l-.22-.38a2 2 0 0 0-2.73-.73l-.15.08a2 2 0 0 1-2 0l-.43-.25a2 2 0 0 1-1-1.73V4a2 2 0 0 0-2-2z\"/>\r\n          <circle cx=\"12\" cy=\"12\" r=\"3\"/>\r\n        </svg>\r\n        Auto Writing\r\n      </button>\r\n    </div>\r\n    <div class=\"menu-body\" style=\"display: none;\">\r\n      <div class=\"menu-row\">\r\n        <label>Submit delay:</label>\r\n        <div class=\"input-group\">\r\n          <div class=\"input-with-unit\">\r\n            <input type=\"number\" min=\"0\" step=\"1\" value=\"0\" id=\"submitDelay1\">\r\n            <span class=\"input-unit\">sec</span>\r\n          </div>\r\n          <span>-</span>\r\n          <div class=\"input-with-unit\">\r\n            <input type=\"number\" min=\"0\" step=\"1\" value=\"0\" id=\"submitDelay2\">\r\n            <span class=\"input-unit\">sec</span>\r\n          </div>\r\n        </div>\r\n      </div>\r\n      <div class=\"menu-row\" style=\"gap: 2px !important;\">\r\n        <label>Answer delay:</label>\r\n        <div class=\"typing-dropdown answer-delay-dropdown\" style=\"margin-left: 10px;\">\r\n          <button class=\"dropdown-btn\" id=\"answerDelayBtn\">None</button>\r\n          <div class=\"dropdown-content\">\r\n            <div class=\"dropdown-option\" data-value=\"none\">None</div>\r\n            <div class=\"dropdown-option\" data-value=\"custom\">Custom</div>\r\n          </div>\r\n        </div>\r\n        <div class=\"input-with-unit custom-delay-input\" style=\"display: none; width: 100px;\">\r\n          <input type=\"number\" min=\"0\" step=\"1\" value=\"0\" id=\"answerDelay\">\r\n          <span class=\"input-unit\">wpm</span>\r\n        </div>\r\n      </div>\r\n      <div class=\"menu-row\">\r\n        <label>Typing Style:</label>\r\n        <div class=\"typing-dropdown\">\r\n          <button class=\"dropdown-btn\" id=\"typingStyleBtn\">None</button>\r\n          <div class=\"dropdown-content\">\r\n            <div class=\"dropdown-option\" data-value=\"default\">None</div>\r\n            <div class=\"dropdown-option\" data-value=\"level1\">Level 1</div>\r\n            <div class=\"dropdown-option\" data-value=\"level2\">Level 2</div>\r\n            <div class=\"dropdown-option\" data-value=\"level3\">Level 3</div>\r\n          </div>\r\n        </div>\r\n      </div>\r\n      <div class=\"menu-row\">\r\n        <label>Placeholder:</label>\r\n        <div class=\"typing-dropdown\">\r\n          <button class=\"dropdown-btn\" id=\"placeholderBtn\">None</button>\r\n          <div class=\"dropdown-content\">\r\n            <div class=\"dropdown-option\" data-value=\"default\">None</div>\r\n            <div class=\"dropdown-option\" data-value=\"enabled\">Enabled</div>\r\n            <div class=\"dropdown-option\" data-value=\"disabled\">Disabled</div>\r\n          </div>\r\n        </div>\r\n      </div>\r\n      \r\n    </div>\r\n  `;\r\n  document.body.appendChild(menu);\r\n\r\n  // 2. ADD STYLES\r\n  const style = document.createElement(\"style\");\r\n  style.textContent = `\r\n    #autoWritingMenu {\r\n      position: fixed;\r\n      top: 100px;\r\n      left: 100px;\r\n      width: 280px;\r\n      background: rgba(24, 24, 27, 0.65);\r\n      border: 1px solid rgba(255, 255, 255, 0.1);\r\n      border-radius: 12px;\r\n      font-family: system-ui, -apple-system, sans-serif;\r\n      z-index: 999999;\r\n      cursor: default;\r\n      color: white;\r\n      backdrop-filter: blur(12px);\r\n      box-shadow: 0 4px 6px -1px rgb(0 0 0 / 0.1), 0 2px 4px -2px rgb(0 0 0 / 0.1);\r\n    }\r\n    .menu-header {\r\n      background: rgba(255, 255, 255, 0.05);\r\n      font-weight: 500;\r\n      user-select: none;\r\n      display: flex;\r\n      align-items: center;\r\n      gap: 10px;\r\n      border-bottom: 1px solid rgba(255, 255, 255, 0.1);\r\n      border-radius: 12px 12px 0 0;\r\n    }\r\n    .menu-title {\r\n      display: flex;\r\n      align-items: center;\r\n      gap: 10px;\r\n      padding: 12px 18px;\r\n      background: rgba(255, 255, 255, 0.1);\r\n      border: 1px solid rgba(255, 255, 255, 0.1);\r\n      border-radius: 6px;\r\n      color: white;\r\n      font-size: 15px;\r\n      font-weight: 500;\r\n      cursor: pointer;\r\n      transition: all 0.2s;\r\n      width: 100%;\r\n    }\r\n    .menu-title:hover {\r\n      background: rgba(255, 255, 255, 0.15);\r\n    }\r\n    .menu-title.active {\r\n      background: rgba(59, 130, 246, 0.5);\r\n      border-color: rgba(59, 130, 246, 0.7);\r\n      color: rgb(219, 234, 254);\r\n    }\r\n    #toggleArrow {\r\n      cursor: pointer;\r\n      transition: all 0.2s;\r\n    }\r\n    #toggleArrow:hover {\r\n      opacity: 0.8;\r\n    }\r\n    #startAutoWritingBtn {\r\n      margin-left: auto;\r\n      cursor: pointer;\r\n      background: rgba(255, 255, 255, 0.1);\r\n      border: 1px solid rgba(255, 255, 255, 0.1);\r\n      color: white;\r\n      padding: 4px 12px;\r\n      border-radius: 6px;\r\n      font-size: 13px;\r\n      transition: all 0.2s;\r\n    }\r\n    #startAutoWritingBtn:hover {\r\n      background: rgba(255, 255, 255, 0.15);\r\n    }\r\n    #startAutoWritingBtn.active {\r\n      background: rgba(59, 130, 246, 0.5);\r\n      border-color: rgba(59, 130, 246, 0.7);\r\n      color: rgb(219, 234, 254);\r\n    }\r\n    input {\r\n      margin-bottom: 0 !important;\r\n      background: rgba(255, 255, 255, 0.05) !important;\r\n      border: 1px solid rgba(255, 255, 255, 0.1) !important;\r\n      color: white !important;\r\n      border-radius: 4px;\r\n      padding: 2px 6px;\r\n    }\r\n    input[type=\"number\"] {\r\n      width: 50px !important;\r\n    }\r\n    .menu-body {\r\n      display: none;\r\n      padding: 16px;\r\n      flex-direction: column;\r\n      gap: 12px;\r\n    }\r\n    .menu-body.show {\r\n      display: flex !important;\r\n    }\r\n    .menu-row {\r\n      display: flex;\r\n      align-items: center;\r\n      gap: 8px;\r\n      font-size: 13px;\r\n      height: 32px;  /* Fixed height for all rows */\r\n    }\r\n    .menu-row label {\r\n      width: 100px;  /* Fixed width for labels */\r\n      margin-right: 4px;\r\n      opacity: 0.9;\r\n    }\r\n    .menu-levels {\r\n      display: flex;\r\n      flex-direction: column;\r\n      align-items: flex-start;\r\n      gap: 8px;\r\n    }\r\n    .level-options {\r\n      display: flex;\r\n      flex-direction: column;\r\n      gap: 8px;\r\n      margin-left: 8px;\r\n      width: 100%;\r\n    }\r\n    .level-options > div {\r\n      display: flex;\r\n      align-items: center;\r\n      gap: 8px;\r\n      padding: 6px 10px;\r\n      background: rgba(255, 255, 255, 0.05);\r\n      border-radius: 6px;\r\n      transition: background 0.2s;\r\n      cursor: pointer;\r\n    }\r\n    .level-options > div:hover {\r\n      background: rgba(255, 255, 255, 0.1);\r\n    }\r\n    .menu-levels input[type=\"radio\"] {\r\n      margin: 0;\r\n      cursor: pointer;\r\n    }\r\n    .menu-levels label {\r\n      margin: 0;\r\n      cursor: pointer;\r\n      font-size: 13px;\r\n    }\r\n    .typing-options {\r\n      display: flex;\r\n      flex-direction: column;\r\n      gap: 8px;\r\n    }\r\n    \r\n    .typing-option {\r\n      width: 100%;\r\n      padding: 6px 10px;\r\n      background: rgba(255, 255, 255, 0.05);\r\n      border: 1px solid rgba(255, 255, 255, 0.1);\r\n      border-radius: 6px;\r\n      color: white;\r\n      text-align: left;\r\n      cursor: pointer;\r\n      transition: all 0.2s;\r\n      font-size: 13px;\r\n    }\r\n    \r\n    .typing-option:hover {\r\n      background: rgba(255, 255, 255, 0.1);\r\n    }\r\n    \r\n    .typing-option.active {\r\n      background: rgba(255, 255, 255, 0.15);\r\n      border-color: rgba(255, 255, 255, 0.2);\r\n    }\r\n    \r\n    .typing-dropdown {\r\n      position: relative;\r\n      width: 150px;\r\n      height: 28px;\r\n    }\r\n    \r\n    .dropdown-btn {\r\n      width: 100%;\r\n      height: 100%;\r\n      padding: 0 12px;\r\n      background: rgba(255, 255, 255, 0.05);\r\n      border: 1px solid rgba(255, 255, 255, 0.1);\r\n      border-radius: 4px;\r\n      color: white;\r\n      text-align: left;\r\n      cursor: pointer;\r\n      transition: all 0.2s;\r\n      font-size: 13px;\r\n      display: flex;\r\n      justify-content: space-between;\r\n      align-items: center;\r\n      box-sizing: border-box;\r\n    }\r\n\r\n    .dropdown-btn::after {\r\n      content: '▼';\r\n      font-size: 10px;\r\n      margin-left: 8px;\r\n    }\r\n\r\n    .dropdown-content {\r\n      display: none;\r\n      position: absolute;\r\n      top: 100%;\r\n      left: 0;\r\n      width: 100%;\r\n      background: rgba(24, 24, 27, 0.95);\r\n      border: 1px solid rgba(255, 255, 255, 0.1);\r\n      border-radius: 4px;\r\n      margin-top: 4px;\r\n      z-index: 1000;\r\n      box-shadow: 0 4px 6px rgba(0, 0, 0, 0.1);\r\n    }\r\n\r\n    .typing-dropdown.active .dropdown-content {\r\n      display: block;\r\n    }\r\n\r\n    .dropdown-option {\r\n      padding: 8px 12px;\r\n      cursor: pointer;\r\n      transition: all 0.2s;\r\n      color: white;\r\n      font-size: 13px;\r\n    }\r\n\r\n    .dropdown-option:hover {\r\n      background: rgba(255, 255, 255, 0.1);\r\n    }\r\n\r\n    .input-group {\r\n      display: flex;\r\n      align-items: center;\r\n      gap: 8px;\r\n      height: 28px;  /* Match other elements */\r\n    }\r\n\r\n    .input-with-unit {\r\n      position: relative;\r\n      width: 60px;\r\n      height: 28px;  /* Fixed height for input containers */\r\n    }\r\n\r\n    /* Remove spinner buttons for Chrome, Safari, Edge, Opera */\r\n    input::-webkit-outer-spin-button,\r\n    input::-webkit-inner-spin-button {\r\n      -webkit-appearance: none;\r\n      margin: 0;\r\n    }\r\n\r\n    /* Remove spinner buttons for Firefox */\r\n    input[type=\"number\"] {\r\n      -moz-appearance: textfield;\r\n    }\r\n\r\n    .input-with-unit input {\r\n      width: 100% !important;\r\n      height: 100% !important;  /* Make input fill container */\r\n      padding-right: 28px !important;\r\n      padding-left: 8px !important;\r\n      text-align: left;\r\n      box-sizing: border-box;\r\n    }\r\n\r\n    .input-unit {\r\n      position: absolute;\r\n      right: 6px;\r\n      top: 50%;\r\n      transform: translateY(-50%);\r\n      font-size: 12px;\r\n      color: rgba(255, 255, 255, 0.5);\r\n      pointer-events: none;\r\n    }\r\n\r\n    /* Ensure all inputs have consistent styling */\r\n    input[type=\"number\"],\r\n    .dropdown-btn {\r\n      background: rgba(255, 255, 255, 0.05) !important;\r\n      border: 1px solid rgba(255, 255, 255, 0.1) !important;\r\n      border-radius: 4px;\r\n      color: white !important;\r\n    }\r\n\r\n    .answer-delay-dropdown {\r\n      margin-right: 8px;\r\n    }\r\n\r\n    .custom-delay-input {\r\n      transition: all 0.3s ease;\r\n    }\r\n  `;\r\n  document.head.appendChild(style);\r\n\r\n  // 3. DRAGGABLE LOGIC\r\n  const header = menu.querySelector(\".menu-header\");\r\n  let offsetX = 0,\r\n    offsetY = 0;\r\n  let isDragging = false;\r\n\r\n  header.addEventListener(\"mousedown\", (e) => {\r\n    // Only start drag if user didn't click the \"Start\" button or arrow\r\n    if (\r\n      e.target.id === \"startAutoWritingBtn\" ||\r\n      e.target.id === \"toggleArrow\" ||\r\n      e.target.id === \"submitDelay1\" ||\r\n      e.target.id === \"submitDelay2\" ||\r\n      e.target.id === \"answerDelay\"\r\n    ) {\r\n      return;\r\n    }\r\n    isDragging = true;\r\n    offsetX = e.clientX - menu.offsetLeft;\r\n    offsetY = e.clientY - menu.offsetTop;\r\n  });\r\n\r\n  document.addEventListener(\"mouseup\", () => {\r\n    isDragging = false;\r\n  });\r\n\r\n  document.addEventListener(\"mousemove\", (e) => {\r\n    if (!isDragging) return;\r\n    e.preventDefault(); // Prevent selecting text while dragging\r\n    menu.style.left = e.clientX - offsetX + \"px\";\r\n    menu.style.top = e.clientY - offsetY + \"px\";\r\n  });\r\n\r\n  // 4. TOGGLE ARROW LOGIC\r\n  const menuTitle = menu.querySelector(\".menu-title\");\r\n  const menuBody = menu.querySelector(\".menu-body\");\r\n\r\n  // Separate handlers for settings icon and Auto Writing button\r\n  const settingsIcon = menu.querySelector(\"#toggleArrow\");\r\n\r\n  // Settings icon only toggles menu\r\n  settingsIcon.addEventListener(\"click\", (e) => {\r\n    e.stopPropagation(); // Prevent triggering the menu-title click\r\n    menuBody.classList.toggle(\"show\");\r\n  });\r\n\r\n  // // Menu title click handler\r\n  // menuTitle.addEventListener(\"click\", (e) => {\r\n  //   // Ignore clicks on the settings icon\r\n  //   if (e.target === settingsIcon || e.target.closest(\"#toggleArrow\")) {\r\n  //     return;\r\n  //   }\r\n\r\n  //   // Toggle active state first\r\n  //   menuTitle.classList.toggle(\"active\");\r\n\r\n  //   // Then update configuration\r\n  //   // updateConfig();\r\n  // });\r\n\r\n  console.log(\"Finished 4th step\");\r\n\r\n  // 5. \"START\" BUTTON LOGIC\r\n  const startButton = menu.querySelector(\".menu-header\");\r\n  startButton.addEventListener(\"click\", () => {\r\n    const submitDelay1 = document.querySelector(\"#submitDelay1\");\r\n    const submitDelay2 = document.querySelector(\"#submitDelay2\");\r\n    const answerDelay = document.querySelector(\"#answerDelay\");\r\n    const answerDelayBtn = document.querySelector(\"#answerDelayBtn\");\r\n    const typingStyleBtn = document.querySelector(\"#typingStyleBtn\");\r\n\r\n    if (\r\n      (submitDelay1.value === \"0\" && submitDelay2.value === \"0\") ||\r\n      parseInt(submitDelay1.value) > parseInt(submitDelay2.value)\r\n    ) {\r\n      alert(\"Error at submit delay\");\r\n      return;\r\n    }\r\n\r\n    if (\r\n      answerDelay.value === \"0\" &&\r\n      answerDelayBtn.textContent.trim() === \"Custom\"\r\n    ) {\r\n      alert(\"Error at answer delay\");\r\n      return;\r\n    }\r\n\r\n    menuTitle.classList.toggle(\"active\");\r\n\r\n    // Collect all the configuration data\r\n    const config = {\r\n      isActive: menuTitle.classList.contains(\"active\"),\r\n      submitDelay: {\r\n        min: parseInt(submitDelay1.value) || 0,\r\n        max: parseInt(submitDelay2.value) || 0,\r\n      },\r\n      answerDelay: parseInt(answerDelay.value) || 0,\r\n      typingStyle: typingStyleBtn.textContent.trim(),\r\n      placeholder: placeholderBtn.textContent.trim(),\r\n    };\r\n\r\n    // Pass the configuration to the callback\r\n    if (typeof onStartCallback === \"function\") {\r\n      onStartCallback(config);\r\n    } else {\r\n      console.warn(\"No start callback provided!\");\r\n    }\r\n  });\r\n\r\n  console.log(\"Finished 5th step\");\r\n\r\n  // 6. OPTIONAL: LEVEL BUTTONS\r\n  const levelRadios = menu.querySelectorAll('input[name=\"level\"]');\r\n  levelRadios.forEach((radio) => {\r\n    radio.addEventListener(\"change\", () => {\r\n      if (radio.checked) {\r\n        const level = radio.value;\r\n        // Insert custom logic for level selection here\r\n      }\r\n    });\r\n  });\r\n\r\n  // Add dropdown functionality for both dropdowns\r\n  const dropdowns = menu.querySelectorAll(\".typing-dropdown\");\r\n\r\n  dropdowns.forEach((dropdown) => {\r\n    const btn = dropdown.querySelector(\".dropdown-btn\");\r\n    const options = dropdown.querySelectorAll(\".dropdown-option\");\r\n\r\n    btn.addEventListener(\"click\", (e) => {\r\n      e.stopPropagation();\r\n      // Close all other dropdowns first\r\n      dropdowns.forEach((d) => {\r\n        if (d !== dropdown) {\r\n          d.classList.remove(\"active\");\r\n        }\r\n      });\r\n      dropdown.classList.toggle(\"active\");\r\n    });\r\n\r\n    options.forEach((option) => {\r\n      option.addEventListener(\"click\", (e) => {\r\n        e.stopPropagation();\r\n        const selectedValue = option.getAttribute(\"data-value\");\r\n        btn.textContent = option.textContent;\r\n        dropdown.classList.remove(\"active\");\r\n\r\n        // Handle custom input for answer delay dropdown\r\n        if (dropdown.classList.contains(\"answer-delay-dropdown\")) {\r\n          const customDelayInput = menu.querySelector(\".custom-delay-input\");\r\n          if (selectedValue === \"custom\") {\r\n            customDelayInput.style.display = \"block\";\r\n          } else {\r\n            customDelayInput.style.display = \"none\";\r\n            document.querySelector(\"#answerDelay\").value = \"0\";\r\n          }\r\n        }\r\n\r\n        updateConfig();\r\n      });\r\n    });\r\n  });\r\n\r\n  // Close dropdowns when clicking outside\r\n  document.addEventListener(\"click\", () => {\r\n    dropdowns.forEach((dropdown) => {\r\n      dropdown.classList.remove(\"active\");\r\n    });\r\n  });\r\n\r\n  // Function to update configuration\r\n  function updateConfig() {\r\n    const config = {\r\n      isActive: menuTitle.classList.contains(\"active\"),\r\n      submitDelay: {\r\n        min: parseInt(document.querySelector(\"#submitDelay1\").value) || 0,\r\n        max: parseInt(document.querySelector(\"#submitDelay2\").value) || 0,\r\n      },\r\n      answerDelay:\r\n        document.querySelector(\"#answerDelayBtn\").textContent === \"Custom\"\r\n          ? parseInt(document.querySelector(\"#answerDelay\").value) || 0\r\n          : 0,\r\n      typingStyle: document.querySelector(\"#typingStyleBtn\").textContent.trim(),\r\n      placeholder: document.querySelector(\"#placeholderBtn\").textContent.trim(),\r\n    };\r\n\r\n    // Validate configuration\r\n    if (config.submitDelay.min > config.submitDelay.max) {\r\n      alert(\"Minimum submit delay cannot be greater than maximum submit delay\");\r\n      return false;\r\n    }\r\n\r\n    if (config.answerDelay < 0) {\r\n      alert(\"Answer delay cannot be negative\");\r\n      return false;\r\n    }\r\n\r\n    // Call the callback with the updated config\r\n    if (typeof onStartCallback === \"function\") {\r\n      onStartCallback(config);\r\n    }\r\n    return true;\r\n  }\r\n\r\n  // Update dropdown option click handlers\r\n  dropdowns.forEach((dropdown) => {\r\n    const options = dropdown.querySelectorAll(\".dropdown-option\");\r\n    options.forEach((option) => {\r\n      option.addEventListener(\"click\", (e) => {\r\n        e.stopPropagation();\r\n        const btn = dropdown.querySelector(\".dropdown-btn\");\r\n        const selectedValue = option.getAttribute(\"data-value\");\r\n        btn.textContent = option.textContent;\r\n        dropdown.classList.remove(\"active\");\r\n\r\n        // Handle custom input for answer delay dropdown\r\n        if (btn.id === \"answerDelayBtn\") {\r\n          const customDelayInput = menu.querySelector(\".custom-delay-input\");\r\n          if (selectedValue === \"custom\") {\r\n            customDelayInput.style.display = \"block\";\r\n          } else {\r\n            customDelayInput.style.display = \"none\";\r\n            document.querySelector(\"#answerDelay\").value = \"0\";\r\n          }\r\n        }\r\n\r\n        // Update configuration after changing dropdown value\r\n        updateConfig();\r\n      });\r\n    });\r\n  });\r\n\r\n  // Initialize configuration with default values\r\n  updateConfig();\r\n}\r\n","// The module cache\nvar __webpack_module_cache__ = {};\n\n// The require function\nfunction __webpack_require__(moduleId) {\n\t// Check if module is in cache\n\tvar cachedModule = __webpack_module_cache__[moduleId];\n\tif (cachedModule !== undefined) {\n\t\treturn cachedModule.exports;\n\t}\n\t// Create a new module (and put it into the cache)\n\tvar module = __webpack_module_cache__[moduleId] = {\n\t\t// no module.id needed\n\t\t// no module.loaded needed\n\t\texports: {}\n\t};\n\n\t// Execute the module function\n\t__webpack_modules__[moduleId](module, module.exports, __webpack_require__);\n\n\t// Return the exports of the module\n\treturn module.exports;\n}\n\n","// define getter functions for harmony exports\n__webpack_require__.d = (exports, definition) => {\n\tfor(var key in definition) {\n\t\tif(__webpack_require__.o(definition, key) && !__webpack_require__.o(exports, key)) {\n\t\t\tObject.defineProperty(exports, key, { enumerable: true, get: definition[key] });\n\t\t}\n\t}\n};","__webpack_require__.o = (obj, prop) => (Object.prototype.hasOwnProperty.call(obj, prop))","// define __esModule on exports\n__webpack_require__.r = (exports) => {\n\tif(typeof Symbol !== 'undefined' && Symbol.toStringTag) {\n\t\tObject.defineProperty(exports, Symbol.toStringTag, { value: 'Module' });\n\t}\n\tObject.defineProperty(exports, '__esModule', { value: true });\n};","// src/main.js\r\n\r\nimport { getAnswer, getHumanScore, saveDB } from \"./api.js\";\r\nimport { displayHumanElement, initDraggableMenu } from \"./ui.js\";\r\n\r\n(function () {\r\n  \"use strict\";\r\n\r\n  let stop = false,\r\n    interval,\r\n    config = {};\r\n\r\n  function getStageFrame() {\r\n    return document.getElementById(\"stageFrame\")\r\n      ? document.getElementById(\"stageFrame\")\r\n      : null;\r\n  }\r\n\r\n  function submitWriting(submitBtn, questions, answers) {\r\n    submitBtn.click();\r\n    console.log(\"Clicked!!!!\");\r\n\r\n    setTimeout(async () => {\r\n      const gradeBar = document.getElementById(\"lessonInfo\");\r\n      const value = gradeBar.querySelectorAll('thspan[data-rwthpgen=\"1\"]');\r\n      console.log(\"Length:\", value.length, value);\r\n      if (value.length === 4) {\r\n        const number = value[2];\r\n        console.log(\"gradeBar:\", gradeBar, number);\r\n        if (number.textContent.trim() === \"100\") {\r\n          console.log(\"Answers:\", answers);\r\n          const response = await getHumanScore(answers);\r\n          const scores = response.humanScore;\r\n\r\n          console.log(\"Scores:\", scores);\r\n          displayHumanElement(scores, \"Human Score\", 170);\r\n\r\n          if (scores) {\r\n            if (typeof scores === \"number\") {\r\n              if (scores >= 90) {\r\n                await saveDB(questions, answers, scores);\r\n              }\r\n            } else {\r\n              for (let i = 0; i < scores.length; i++) {\r\n                if (scores[i] >= 90) {\r\n                  await saveDB(questions[i], answers[i], scores[i]);\r\n                }\r\n              }\r\n            }\r\n          }\r\n        }\r\n      }\r\n    }, 15000);\r\n  }\r\n\r\n  // Helper functions for humanized typing\r\n  function createTypingMistake(word, typingStyle) {\r\n    const mistakeTypes = {\r\n      swap: (w) => {\r\n        if (w.length < 2) return w;\r\n        const i = Math.floor(Math.random() * (w.length - 1));\r\n        return w.slice(0, i) + w[i + 1] + w[i] + w.slice(i + 2);\r\n      },\r\n      typo: (w) => {\r\n        const nearby = {\r\n          a: \"sq\",\r\n          b: \"vn\",\r\n          c: \"xv\",\r\n          d: \"sf\",\r\n          e: \"wr\",\r\n          f: \"dg\",\r\n          g: \"fh\",\r\n          h: \"gj\",\r\n          i: \"uo\",\r\n          j: \"hk\",\r\n          k: \"jl\",\r\n          l: \"k\",\r\n          m: \"n\",\r\n          n: \"bm\",\r\n          o: \"ip\",\r\n          p: \"o\",\r\n          q: \"a\",\r\n          r: \"et\",\r\n          s: \"ad\",\r\n          t: \"ry\",\r\n          u: \"yi\",\r\n          v: \"bc\",\r\n          w: \"e\",\r\n          x: \"c\",\r\n          y: \"tu\",\r\n          z: \"\",\r\n        };\r\n        if (w.length < 1) return w;\r\n        const i = Math.floor(Math.random() * w.length);\r\n        const char = w[i].toLowerCase();\r\n        const typoChar = nearby[char]\r\n          ? nearby[char][Math.floor(Math.random() * nearby[char].length)]\r\n          : char;\r\n        return w.slice(0, i) + typoChar + w.slice(i + 1);\r\n      },\r\n      shuffle: (w) =>\r\n        w\r\n          .split(\"\")\r\n          .sort(() => Math.random() - 0.5)\r\n          .join(\"\"),\r\n    };\r\n\r\n    const mistakeType =\r\n      typingStyle === \"Level 1\"\r\n        ? \"swap\"\r\n        : typingStyle === \"Level 2\"\r\n        ? \"typo\"\r\n        : \"shuffle\";\r\n    console.log(\"Mistake Type:\", mistakeType);\r\n    return mistakeTypes[mistakeType](word);\r\n  }\r\n\r\n  function createTypingAnimation(editor, text, config, onComplete) {\r\n    const words = text.split(\" \");\r\n    let currentIndex = 0;\r\n    editor.setData(\"\");\r\n\r\n    const msPerWord = (60 * 1000) / (config.answerDelay || 30); // Default to 30 WPM if not set\r\n    const typingStyle = config.typingStyle;\r\n    const placeholderEnabled = config.placeholder === \"Enabled\";\r\n    const placeholderText =\r\n      \"This topic has many sides to consider, each offering unique insights required to understand.\";\r\n\r\n    const typeText = async (textToType, isPlaceholder = false) => {\r\n      return new Promise((resolve) => {\r\n        let wordIndex = 0;\r\n        const words = textToType.split(\" \");\r\n\r\n        const typeWord = () => {\r\n          if (wordIndex < words.length) {\r\n            let word = words[wordIndex];\r\n            let letterIndex = 0;\r\n            const letters = word.split(\"\");\r\n            let mistakeMode = false;\r\n            let mistakeText = \"\";\r\n            let backspacing = false;\r\n\r\n            const typeLetter = () => {\r\n              if (backspacing) {\r\n                if (mistakeText.length > 0) {\r\n                  mistakeText = mistakeText.slice(0, -1);\r\n                  let baseText =\r\n                    wordIndex === 0\r\n                      ? \"\"\r\n                      : words.slice(0, wordIndex).join(\" \") + \" \";\r\n                  editor.setData(baseText + mistakeText);\r\n                  setTimeout(typeLetter, msPerWord / word.length);\r\n                } else {\r\n                  backspacing = false;\r\n                  mistakeMode = false;\r\n                  letterIndex = 0;\r\n                  setTimeout(typeLetter, msPerWord / word.length);\r\n                }\r\n                return;\r\n              }\r\n\r\n              // Only make typing mistakes for actual answer, not placeholder\r\n              if (!isPlaceholder && !mistakeMode && letterIndex === 0) {\r\n                const mistakeChance =\r\n                  {\r\n                    \"Level 1\": 0.05,\r\n                    \"Level 2\": 0.15,\r\n                    \"Level 3\": 0.25,\r\n                  }[typingStyle] || 0;\r\n\r\n                mistakeMode = Math.random() < mistakeChance;\r\n                if (mistakeMode) {\r\n                  mistakeText = createTypingMistake(word);\r\n                }\r\n              }\r\n\r\n              if (\r\n                letterIndex <\r\n                (mistakeMode ? mistakeText.length : letters.length)\r\n              ) {\r\n                let baseText =\r\n                  wordIndex === 0\r\n                    ? \"\"\r\n                    : words.slice(0, wordIndex).join(\" \") + \" \";\r\n                let currentWord = mistakeMode\r\n                  ? mistakeText.slice(0, letterIndex + 1)\r\n                  : letters.slice(0, letterIndex + 1).join(\"\");\r\n\r\n                editor.setData(baseText + currentWord);\r\n                letterIndex++;\r\n\r\n                if (mistakeMode && letterIndex === mistakeText.length) {\r\n                  backspacing = true;\r\n                  setTimeout(typeLetter, msPerWord / 2);\r\n                  return;\r\n                }\r\n\r\n                setTimeout(typeLetter, msPerWord / word.length);\r\n              } else {\r\n                let completeText =\r\n                  words.slice(0, wordIndex).join(\" \") +\r\n                  (wordIndex > 0 ? \" \" : \"\") +\r\n                  (mistakeMode ? mistakeText : word);\r\n\r\n                editor.setData(completeText);\r\n                wordIndex++;\r\n                setTimeout(typeWord, msPerWord);\r\n              }\r\n            };\r\n\r\n            typeLetter();\r\n          } else {\r\n            resolve();\r\n          }\r\n        };\r\n\r\n        typeWord();\r\n      });\r\n    };\r\n\r\n    const deletePlaceholder = async () => {\r\n      return new Promise((resolve) => {\r\n        let text = editor.getData();\r\n        const deleteChar = () => {\r\n          if (text.length > 0) {\r\n            text = text.slice(0, -1);\r\n            editor.setData(text);\r\n            setTimeout(deleteChar, msPerWord / 10); // Faster deletion\r\n          } else {\r\n            resolve();\r\n          }\r\n        };\r\n        deleteChar();\r\n      });\r\n    };\r\n\r\n    const startTyping = async () => {\r\n      if (placeholderEnabled) {\r\n        // Type placeholder first\r\n        await typeText(placeholderText, true);\r\n        // Wait a bit to simulate thinking\r\n        await new Promise((resolve) => setTimeout(resolve, 2000));\r\n        // Delete placeholder\r\n        await deletePlaceholder();\r\n        // Wait a bit before typing real answer\r\n        await new Promise((resolve) => setTimeout(resolve, 1000));\r\n      }\r\n\r\n      // Type actual answer\r\n      await typeText(text, false);\r\n\r\n      // Complete the animation\r\n      if (onComplete) onComplete();\r\n    };\r\n\r\n    // Start the typing process\r\n    setTimeout(() => {\r\n      startTyping();\r\n    }, 2000);\r\n  }\r\n\r\n  async function activateAutomaticWriting() {\r\n    console.log(\"Get started!!!~~~~~~~~~~~!!!\");\r\n\r\n    // 1. INITIALIZE THE DRAGGABLE MENU\r\n    initDraggableMenu((conf) => {\r\n      console.log(\"Config:\", conf);\r\n      config = conf;\r\n    }); // <--- Add this line to show the UI\r\n\r\n    const stageFrame = getStageFrame();\r\n    if (!stageFrame) return;\r\n\r\n    interval = setInterval(async () => {\r\n      if (stop) {\r\n        console.log(\"Stopping script because pastContent is detected.\");\r\n        clearInterval(interval); // Stop the script from running further\r\n        return;\r\n      }\r\n\r\n      const examTitle = document.getElementById(\"activity-title\")?.innerText;\r\n      if (\r\n        !examTitle ||\r\n        document.getElementById(\"activity-status\")?.innerText === \"Complete\"\r\n      ) {\r\n        const journalText = stageFrame?.contentWindow.document\r\n          .getElementById(\"journal-ckeditor\")\r\n          ?.innerText?.trim();\r\n        const linkText = stageFrame?.contentWindow.document\r\n          .querySelector(\".OnlineContent-textArea-div\")\r\n          ?.innerText?.trim();\r\n\r\n        let pastContent = journalText || linkText;\r\n        console.log(\"Completed!!!!!!!\", pastContent);\r\n        if (pastContent) {\r\n          stop = true;\r\n          const scores = 77;\r\n          displayHumanElement(scores, \"Human Score\", 170);\r\n          clearInterval(interval); // Stop execution\r\n        }\r\n        return;\r\n      }\r\n\r\n      if (!config.isActive) {\r\n        console.log(\"Start button not clicked yet.\");\r\n        return;\r\n      }\r\n\r\n      if (!stageFrame.contentWindow?.CKEDITOR) {\r\n        console.log(\"CKEditor not displayed!!!!!\");\r\n        return;\r\n      }\r\n\r\n      const links = stageFrame.contentDocument?.querySelectorAll(\r\n        \"#contentViewer #OnlineContent-Links .weblink\"\r\n      );\r\n\r\n      console.log(\"Links:\", links);\r\n\r\n      if (!links?.length) {\r\n        clearInterval(interval);\r\n        const text =\r\n          stageFrame.contentWindow.document.getElementById(\"journal-prompt\") ||\r\n          stageFrame.contentWindow.document.querySelector(\r\n            \".text-box-container\"\r\n          );\r\n        const editor =\r\n          stageFrame.contentWindow.CKEDITOR.instances[\"Answer\"] ||\r\n          stageFrame.contentWindow.CKEDITOR.instances[\"essay-Content\"];\r\n\r\n        editor.setData(\"Sit tight while Revolt generates a response... ✨\");\r\n\r\n        try {\r\n          // const res = await getAnswer(text?.innerText);\r\n          // console.log(res);\r\n          // const answer = res.humanizedText;\r\n          // console.log(\"Answer:\", answer);\r\n\r\n          const answer = `The High Renaissance – my most favored period in art history. It's just the coolest thing, isn't it? The years from 15th to 17th century Italy Florence, Rome and Venice were home to some of the most iconic artists and works we see among us that inspires us till the date.\r\n          The High Renaissance – my most favored period in art history. It's just the coolest thing, isn't it? The years from 15th to 17th century Italy Florence, Rome and Venice were home to some of the most iconic artists and works we see among us that inspires us till the date.\r\n          The High Renaissance – my most favored period in art history. It's just the coolest thing, isn't it? The years from 15th to 17th century Italy Florence, Rome and Venice were home to some of the most iconic artists and works we see among us that inspires us till the date.\r\n          `;\r\n\r\n          createTypingAnimation(editor, answer, config, () => {\r\n            const submitBtn =\r\n              stageFrame.contentWindow.document.getElementById(\r\n                \"SubmitButton\"\r\n              ) ||\r\n              stageFrame.contentWindow.document.querySelector(\r\n                \".uibtn.uibtn-blue.uibtn-med.uibtn-alt\"\r\n              );\r\n            submitBtn.disabled = false;\r\n            submitWriting(submitBtn, text?.innerText, answer);\r\n          });\r\n        } catch (error) {\r\n          console.error(\"Error:\", error);\r\n        }\r\n      } else {\r\n        console.log(\"Links length:\", links.length);\r\n        clearInterval(interval);\r\n        let answered = 0;\r\n        const needToAnswer = Object.keys(\r\n          stageFrame.contentWindow.CKEDITOR.instances\r\n        ).length;\r\n        console.log(\"needToAnswer:\", needToAnswer);\r\n\r\n        Object.keys(stageFrame.contentWindow.CKEDITOR.instances).forEach(\r\n          async (key) => {\r\n            console.log(\"Key:\", key);\r\n            const editor = stageFrame.contentWindow.CKEDITOR.instances[key];\r\n            const question = stageFrame.contentDocument\r\n              .getElementById(editor.name)\r\n              ?.parentElement?.querySelector(\"p\")?.innerText;\r\n            console.log(\"Question:\", question);\r\n\r\n            let siteNumber = question?.match(/\\( *Site *[0-9]+ *\\)/g)?.join(\"\");\r\n            siteNumber = siteNumber?.replace(/\\( *Site *([0-9]+) *\\)/, \"$1\");\r\n\r\n            editor.setData(\"Sit tight while Revolt generates a response... ✨\");\r\n\r\n            let answers = [],\r\n              questions = [];\r\n\r\n            try {\r\n              const endpoint = siteNumber\r\n                ? links[parseInt(siteNumber) - 1]?.getAttribute(\"href\")\r\n                : links[0]?.getAttribute(\"href\");\r\n\r\n              const response = await fetch(endpoint);\r\n              const aRes = await response.text();\r\n              const parser = new DOMParser();\r\n              const doc = parser.parseFromString(aRes, \"text/html\");\r\n\r\n              doc.querySelector(\"footer\")?.remove();\r\n\r\n              const extractedText = [\"h1\", \"h2\", \"p\", \"li\"].reduce(\r\n                (acc, tag) => {\r\n                  Array.from(doc.getElementsByTagName(tag)).forEach(\r\n                    (element) => {\r\n                      acc += element.textContent?.trim() + \" \";\r\n                    }\r\n                  );\r\n                  return acc.trim();\r\n                },\r\n                \"\"\r\n              );\r\n\r\n              const examTitle =\r\n                document.getElementById(\"activity-title\")?.innerText;\r\n              if (\r\n                examTitle === \"Online Content\" &&\r\n                GM_getValue(\"settings\") &&\r\n                GM_getValue(\"settings\")[\"auto-writing-use\"] ===\r\n                  \"Keywords (100% Accuracy)\"\r\n              ) {\r\n                editor.setData(extractedText);\r\n                answered++;\r\n              } else {\r\n                // const res = await getAnswer(extractedText + \"\\n\" + question);\r\n                // const answer = res.humanizedText.replace(/\\*/g, \"\");\r\n                const answer = `The High Renaissance – my most favored period in art history. It's just the coolest thing, isn't it? The years from 15th to 17th century Italy Florence, Rome and Venice were home to some of the most iconic artists and works we see among us that inspires us till the date.`;\r\n                answers.push(answer);\r\n                questions.push(question);\r\n\r\n                if (!config.isActive) {\r\n                  editor.setData(answer);\r\n                  answered++;\r\n                } else {\r\n                  createTypingAnimation(editor, answer, config, () => {\r\n                    answered++;\r\n                    if (answered === needToAnswer) {\r\n                      const submitBtn =\r\n                        stageFrame.contentWindow.document.getElementById(\r\n                          \"SubmitQuestionsButton\"\r\n                        );\r\n                      submitBtn.disabled = false;\r\n                      submitWriting(\r\n                        submitBtn,\r\n                        questions,\r\n                        answers,\r\n                        needToAnswer\r\n                      );\r\n                    }\r\n                  });\r\n                }\r\n              }\r\n            } catch (error) {\r\n              console.error(\"Error processing link:\", error);\r\n            }\r\n          }\r\n        );\r\n      }\r\n    }, 1000);\r\n  }\r\n\r\n  activateAutomaticWriting();\r\n})();\r\n"],"names":[],"sourceRoot":""}